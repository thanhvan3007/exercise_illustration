---
title: "Economics Scatterplot"
format: 
  html:
    code-fold: true
    mainfont: cursive
editor: visual
theme: quartz
warning: false
output: true

---


The aim of this challenge is to recreate the plot below originally published in [The Economist](https://www.economist.com/blogs/dailychart/2011/12/corruption-and-development). The graph is a scatterplot showing the relationship between *Corruption Index* and *Human Development Index* for various countries.

First, add database and set factor.

```{r}
#load libraries
#install.packages("tidyverse")
library(tidyverse)
library(ggplot2)
#install.packages("RColorBrewer")
library(RColorBrewer)

ec <- read.csv("data_economist.csv",header=T)
head(ec)
str(ec)
levels(ec$Region)

ec$Region <- factor(ec$Region,levels = c("EU W. Europe",
                                "Americas",
                                "Asia Pacific",
                                "East EU Cemt Asia",
                                "MENA",
                                "SSA"),
                     labels = c("OECD",
                                "Americas",
                                "Asia &\nOceania",
                                "Central &\nEastern Europe",
                                "Middle East &\nNorth Africa",
                                "Sub-Saharan\nAfrica"))

ec$Region

head(ec)

labels <- c("Congo","Afghanistan","Sudan","Myanmar","Iraq","Venezuela","Russia","Argentina","Brazil","Italy","South Africa","Cape Verde","Bhutan","Botswana","Britian","New Zealand","Greece","China","India","Rwanda","Spain","France","United States","Japan","Norway","Singapore","Barbados","Germany")

```

Draw the plot first with x = CPI and y= HDI

```{r}


p <- ec %>% ggplot(aes(x=CPI, y=HDI, color=Region)) +
  geom_point(shape = 1, size = 3, fill ="white", stroke = 0.8) +
  geom_smooth(method="lm",formula=y~poly(x,2),se=F,size=0.6, color="red") 

p+ geom_text(data=subset(ec,Country %in% labels), 
             aes(label=Country), color="black", size = 3)

```
Now avoid overlapping of labels

```{r}

#install.packages("ggrepel") #packages that help to change font 
library(ggrepel)
p <- p+geom_text_repel(data=subset(ec,Country %in% labels),aes(label=Country),
                       color="black",box.padding=unit(1,'lines'),segment.size=0.25,
                       size=3,family="Gidole")
p
```
Change the scale of x and y axis

```{r}

p <- p+scale_x_continuous(name="Corruption Perceptions Index, 2011 (10=least corrupt)",
                          breaks=1:10,limits=c(1,10))+
      scale_y_continuous(name="Human Development Index, 2011 (1=best)",
                         breaks=seq(from=0,to=1,by=0.1),limits=c(0.2,1))
p
```
And done. 